<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul:nth-of-type(1) > li > a, .site-nav > ul:nth-of-type(1) > li > ul > li:not(:nth-child(3)) > a, .site-nav > ul:nth-of-type(1) > li > ul > li > ul > li a { background-image: none; } .site-nav > ul:not(:nth-of-type(1)) a, .site-nav li.external a { background-image: none; } .site-nav > ul:nth-of-type(1) > li:nth-child(1) > ul > li:nth-child(3) > a { font-weight: 600; text-decoration: none; }.site-nav > ul:nth-of-type(1) > li:nth-child(1) > button svg, .site-nav > ul:nth-of-type(1) > li:nth-child(1) > ul > li:nth-child(3) > button svg { transform: rotate(-90deg); }.site-nav > ul:nth-of-type(1) > li.nav-list-item:nth-child(1) > ul.nav-list, .site-nav > ul:nth-of-type(1) > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(3) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Overlap Measure | Cristian Compean</title> <meta name="generator" content="Jekyll v3.10.0" /> <meta property="og:title" content="Overlap Measure" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Portfolio website for Cristian Compean" /> <meta property="og:description" content="Portfolio website for Cristian Compean" /> <link rel="canonical" href="http://localhost:4000/docs/sampling/2025-05-27overlap" /> <meta property="og:url" content="http://localhost:4000/docs/sampling/2025-05-27overlap" /> <meta property="og:site_name" content="Cristian Compean" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2025-05-27T00:00:00-05:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Overlap Measure" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-05-27T00:00:00-05:00","datePublished":"2025-05-27T00:00:00-05:00","description":"Portfolio website for Cristian Compean","headline":"Overlap Measure","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/docs/sampling/2025-05-27overlap"},"url":"http://localhost:4000/docs/sampling/2025-05-27overlap"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Cristian Compean </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Sampling category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/Sampling/2025-05-28-sampling.html" class="nav-list-link">Sampling</a><ul class="nav-list"><li class="nav-list-item"><a href="/2025/05/19/rejection-sampling" class="nav-list-link">Rejection Sampling</a></li><li class="nav-list-item"><a href="/2025/05/18/Metropolis-Hastings" class="nav-list-link">Metropolis-Hastings Algorithm</a></li><li class="nav-list-item"><a href="/docs/sampling/2025-05-27overlap" class="nav-list-link">Overlap Measure</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Cristian Compean" aria-label="Search Cristian Compean" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/Sampling/2025-05-28-sampling.html">Sampling</a></li> <li class="breadcrumb-nav-list-item"><span>Overlap Measure</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'], inlineMath: [['\\(','\\)'], ['$', '$']] } }); </script> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> <h1 id="overlap"> <a href="#overlap" class="anchor-heading" aria-labelledby="overlap"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overlap </h1> <p>Throughout this analysis, there’s been mention to the notion of overlap between two distributions. The goal of this section is to define overlap and how we can leverage its interpretation in application over the commonly used p-value.</p> <h2 id="overlap-in-rejection-sampling"> <a href="#overlap-in-rejection-sampling" class="anchor-heading" aria-labelledby="overlap-in-rejection-sampling"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overlap in Rejection Sampling </h2> <p>When describing the rejection sampling algorithm, we showed that we could define the probability a sample was accepted as $\frac{1}{M}$. Here the constant M is defined as: \(\sup_{x \in \Omega}\frac{q(x)}{p(x)}\) Note that if $q(x) = p(x)$ then the sample would always be accepted.</p> <p>Similarly, if $q(x) = c p(x)$ where c is a constant, then the probability of acceptance would become $\frac{1}{c}$. Of course, this definition leads to conclusion that if two distributions are more “overlapping”, then the probability of acceptance draws closer to 1 (Figure add). The challenge with rejection sampling is $M &lt; \infty$. Often times, M being less than infinity is not the case removing both the interpretation of overlap and rendering rejection sampling useless. We’d like to find a way to remove this unnecessary constraint and find a definition of overlap that works for any $p(x)$, $q(x)$.</p> <h2 id="overlap-in-metropolis-hastings"> <a href="#overlap-in-metropolis-hastings" class="anchor-heading" aria-labelledby="overlap-in-metropolis-hastings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overlap in Metropolis-Hastings </h2> <p>The second sampling algorithm we analyzed was the Metropolis-Hastings algorithm. One of the key properties of MH we derived was that it guarantees convergence to the stationary distribution under the condition of detailed balance. This provides an algorithm that works for any $p(x), q(x)$ regardless of how slow that convergence may be. This provides a significant advantage over Rejection Sampling since we can define overlap for any $p(x)$ and $q(x)$. However, the challenge now is defining overlap in the MH algorithm.</p> <p><br /></p> <p><strong>Claim:</strong> The integral $\int \int \alpha(x’,x)p(x)q(x’)\text{d}x\text{d}x’$ gives us a measure of overlap of the MH algorithm.</p> <p><br /> We’ll define Z to be a Bernoulli random variable indicating whether or not our sample was rejected and we’ll start with the following set up:</p> <p>Suppose a target distribution $q(x)$ and a proposal distribution $p(x)$. Let $X \sim q(x)$ and $Y \sim p(y)$. We’d like to know the probability X can replace Y after the test: $u &lt; \alpha(X, Y)$.</p> <p>Define $z$ to be a r.v st: \(X' = \begin{cases} X \text{ with probability } \alpha(X, Y) \\ Y \text{ with probability } 1-\alpha(X, Y) \end{cases}\) <br /></p> <p>We’d like show $X’ \sim q(x)$.</p> <p>Clearly if we reject our sample $X$, $X’ \sim q$ since $X’ = Y$. If we accept the sample, then we were saying $X$ can replace $Y$. We can make the following observation of the probability of replacement:</p> <p>\(\Pr(Z=1 \cap X' \in A | X) = \int \int \int_A 1(U &lt; \alpha(X, Y)) q(x)p(y)\text{d}u\text{d}x\text{d}y\) \(= \int \int \alpha(x,y)q(x)p(y)\text{d}x\text{d}y\) Where $A$ is the sample space of $q(x)$. This is our overlap measure, we call it r. \(r = \int \int \alpha(x,y)q(x)p(y)\text{d}x\text{d}y\) Since r is a well defined probability, $r \in [0,1]$ and has the following interpretation:</p> <ol> <li>If r is close to zero, that indicates the target and proposal are distinct distributions since there is a low replacement probability. <li>If r is close to one, then the proposal and distinct are similar distributions. <li>Computing r directly may not be always possible, the probability must be estimated using Monte Carlo methods. &lt;/ol&gt; <br /> In conclusion, since the Metropolis Hastings converges to the target distribution for any proposal distribution, the overlap measure for the Metropolis Hastings works for any two $p(x)$ and $q(x)$. This allows us to determine the similarity between samples coming from two different distributions by determining how likely one sample is to replace the other. ## Similarity measures: p-value vs Overlap The p-value is the probability a test statistic is at least as extreme as the actual observed value, given that a null hypothesis is true. One common application of the p-value is to test the differences between two populations (X and Y) by using the means from the observed samples and constructing the following null hypothesis: $$ H_0 \colon \ \mu_X - \mu_Y = 0 \quad H_1 \colon \ \mu_X - \mu_Y \neq 0 $$ We arrive at what is referred to as the two sample t-test. By rejecting the null hypothesis, we accept strong evidence to suggest the means are not the same, indicating a difference between the two populations. The threshold for p-value (commonly referred to as $\alpha$) is selected based on a widely accepted consensus, typically .05. However, given the goal is to measure differences between two populations, the threshold we set for the p-value is uninformative about the difference between the two populations. Instead of the p-value, we'd like to focus on $r$ and its interpretation as a measure of replacement between two populations to describe similarity between distinct distributions. ### Example: p-value vs. Overlap For this example, we'll consider two populations: $$X_1, X_2, ..., X_N \text{ i.i.d from N(0,1)} $$ and $$Y_1, Y_2, ..., Y_N \text{ i.i.d from N(}\mu \text{,1)}$$ where $\mu \in [0,2]$. We'd like to compare the similarity of the two distributions using both a two sample mean test and $r$ and highlight the difference between the two measures as $\mu$ grows larger and the distributions grow farther apart. Since $r$ cannot be directly computed, it must be estimated using Monte Carlo methods. We'll estimate r using the following code: ``` python import pandas as pd import scipy import numpy as np # Generate data np.random.seed(42) # For reproducibility means = np.arange(0, 200) / 100 x = scipy.stats.norm.rvs(size=50) y = scipy.stats.norm.rvs(size=50) # Fit KDE for x (fixed) fx_hat = scipy.stats.gaussian_kde(x) fx_s = fx_hat.resample(1000).flatten() # Pre-sample overlaps = [] p_values = [] for mu in means: y_mu = y + mu # Fit KDE for shifted y fy_hat = scipy.stats.gaussian_kde(y_mu) #Drawing 1000 samples from the fy hat fy_s = fy_hat.resample(1000).flatten() # Two-sample t-test (two-sided by default) tstat, p_val = scipy.stats.ttest_ind(x, y_mu, equal_var=False) # Welch's t-test p_values.append(p_val) # Monte Carlo overlap estimation eps = 1e-10 # Small constant to avoid division by zero numerator = fx_hat(fy_s) * fy_hat(fx_s) denom = fx_hat(fx_s) * fy_hat(fy_s) alpha = np.minimum(1, (numerator / denom)) overlaps.append(np.mean(alpha)) # Store results df = pd.DataFrame({'Overlap': overlaps, 'p-value': p_values}, index=means) ``` We obtain the following result: \includegraphics[width=0.7\linewidth]{overlap (normal).png} From this example we see as the p-value dips below .05 and we begin to reject the null hypothesis, the overlap remains high at roughly .75 probability a sample from $\text{N(0,1)}$ could replace a sample from $\text{N(}\mu,1)$. From this example, we see the additional information we gain from using the overlap measure could be far more valuable to the researcher since three-fourth's of samples from one group could replace those of the other group. </li></li></li></ol> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
