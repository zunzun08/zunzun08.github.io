<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(1) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Rejection Sampling | Cristian Compean</title> <meta name="generator" content="Jekyll v3.10.0" /> <meta property="og:title" content="Rejection Sampling" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Portfolio website for Cristian Compean" /> <meta property="og:description" content="Portfolio website for Cristian Compean" /> <link rel="canonical" href="http://localhost:4000/docs/Sampling/2025/05/19/rejection-sampling" /> <meta property="og:url" content="http://localhost:4000/docs/Sampling/2025/05/19/rejection-sampling" /> <meta property="og:site_name" content="Cristian Compean" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Rejection Sampling" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Portfolio website for Cristian Compean","headline":"Rejection Sampling","url":"http://localhost:4000/docs/Sampling/2025/05/19/rejection-sampling"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Cristian Compean </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Sampling category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/Sampling/2025/05/28/sampling" class="nav-list-link">Sampling</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/Sampling/2025/05/19/rejection-sampling" class="nav-list-link">Rejection Sampling</a></li><li class="nav-list-item"><a href="/docs/Sampling/2025/05/18/Metropolis-Hastings" class="nav-list-link">Metropolis-Hastings Algorithm</a></li><li class="nav-list-item"><a href="/docs/Sampling/2025/05/27/overlap" class="nav-list-link">Overlap Measure</a></li></ul></li><li class="nav-list-item"><a href="/Portfolio/2025/06/10/portfolio-website-blog" class="nav-list-link">Portfolio Updates</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Cristian Compean" aria-label="Search Cristian Compean" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/Sampling/2025/05/28/sampling">Sampling</a></li> <li class="breadcrumb-nav-list-item"><span>Rejection Sampling</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'], inlineMath: [['\\(','\\)'], ['$', '$']] } }); </script> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> <h1 id="rejection-sampling"> <a href="#rejection-sampling" class="anchor-heading" aria-labelledby="rejection-sampling"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rejection Sampling </h1> <h2 id="introduction"> <a href="#introduction" class="anchor-heading" aria-labelledby="introduction"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Introduction </h2> <p>Rejection Sampling is an algorithm that provides us with an intuitive way to sample random variables from a <strong>target distribution</strong>, $q(x)$, that cannot be sampled from directly but whose function form is known. We do so by using a <strong>proposal distribution</strong>, $p(x)$, that can be sampled from directly. The rejection sampling algorithm requires samples drawn from $p(x)$ to be evaluated on a probability the sample can be assumed to have been drawn from $q(x)$. If the sample is not assumed to be drawn from $q(x)$, the sample is rejected and the process is repeated. The underlying acceptance of the sample drawn from $p(x)$ relies on the overlap between $p(x)$ and $q(x)$. If $p(x)$ and $q(x)$ are similar distributions then we say the two distributions have high overlap and samples drawn from either distribution could be said to have been drawn from the other. The opposite is true for distributions with low overlap. Rejection sampling provides us with an introductory understanding of overlap as we define the likelihood samples can replace each other with the constant $M$:</p> \[M = \sup_{x \in \Omega} \frac{q(x)}{p(x)} &lt; \infty\] <p>We note that $M \geq 1$: <br /></p> <h3 id="proof"> <a href="#proof" class="anchor-heading" aria-labelledby="proof"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Proof:</strong> </h3> <p>Suppose $ M &lt; 1 $.</p> <p>Since $M$ is the supremum of $\frac{q(x)}{p(x)}$, then for all $x$: \(M \geq \frac{q(x)}{p(x)} \implies M p(x) \geq q(x).\)</p> <p>Integrating both sides:</p> \[M \int p(x) \, dx \geq \int q(x) \, dx.\] <p>Since $ p(x) $ and $ q(x) $ are p.d.f.s, $ \int p(x) \, dx = \int q(x) \, dx = 1 $. Thus, M \geq 1,</p> <p>which contradicts the assumption $ M &lt; 1 $.</p> <p><strong>QED</strong></p> <p>Since $M \geq 1$, we know the following must be true for $q(x)$: <br /></p> <ol> <li>$q(x) \geq p(x) \space \forall x \in \Omega$ <br /></li> <li>$p(x)$ and $q(x)$ share the same $\Omega$</li> </ol> <p>In rejection sampling, we define overlap with $M$ since $M$ serves as a measure of similarity between $p(x)$ and $q(x)$. If $M$ is very close to 1, $p(x)$ and $q(x)$ are quite similar. If $M$ is very close to 0, $p(x)$ and $q(x)$ are not similar. Note, a downside to rejection sampling is that $M$ must exist which heavily constrains the number of density functions we can apply rejection sampling sampling to. However, we know based on what was said above, the following figure shows us the relationship between $p(x)$ and $q(x)$.</p> <p>Once we’ve determined $M$, we can generate samples $X_1,X_2,…,X_n$ from $p(x)$ and apply the rejection sampling algorithm. We will show the accepted samples will then follow the target distribution $q(x)$.</p> <p>We can condense the above into the following algorithm:</p> <p>1.Draw a sample $X \sim p(x)$</p> <p>2.Draw a sample $u \sim U[0,1]$</p> <p>3.If $u &lt; \frac{q(x)}{M*p(x)}$ then $X \sim q$, else: Discard $X$ and $u$</p> <p>4.Repeat</p> <p>Here is an example of the algorithm implemented in Python:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import numpy as np
import scipy
def rejection_sampling(num_samples, M, prop_dist, target_dist):
    samples = []
    for _ in range(num_samples):
            x = prop_dist.rvs()  #Random variable from our proposed distribution
            u = scipy.stats.uniform.rvs()    #Random variable from our uniform distribution
                
            #Ratio is the realized random variable evaluated at both the proposed and the target distributions

            ratio = target_dist.pdf(x) / (prop_dist.pdf(x)*M)
            
            
            if u &lt;= (ratio):  # Accept-reject condition
                
                samples.append(x)
    return np.array(samples)
</code></pre></div></div> <h3 id="example"> <a href="#example" class="anchor-heading" aria-labelledby="example"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example </h3> <p>Here we use $p \sim \text{Exp}(\lambda = \frac{1}{2})$ to target a standard exponential distribution:</p> <p align="center"> <img src="/assets/rejection_sampling_example.png" alt="RS Exp Example" width="400" /> </p> <h3 id="proof-of-rejection-sampling"> <a href="#proof-of-rejection-sampling" class="anchor-heading" aria-labelledby="proof-of-rejection-sampling"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Proof of Rejection Sampling </h3> <p>Our goal is to show that if we follow the rejection sample algorithm, the random variable we drew $X$ from $p(x)$, can be said $X \sim q(x)$. Probability theory tells us that if $X \sim q(x)$, the following are equivalent:</p> \[\Pr(X \in A) = \int_A q(x)\text{dx} = Q(x)\] <p>Where $A$ is sample space of $q(x)$. This will be the idea we wish to prove.</p> <p>When we run the rejection sampling algorithm, there exists some probability we accept or reject the sample. This probability is random before the algorithm begins and based on the fact that we accept or reject, the outcome is binary. Whether or not the outcome occurs for every iteration of the algorithm is a random variable (r.v) that we call $Z$. We’ve defined the conditions when a sample $X$ is accepted rejected in the algorithm and it is based on the inequality:</p> <p>$U &lt; \frac{q(x)}{M*p(x)}$</p> <p>It follows that since M is the supremum of $\frac{q(x)}{p(x)}$, if $M$ exists then $\frac{q(x)}{M*p(x)}$ is bounded on the interval of $[0,1]$ for all $x$ in the support of $p(x)$ and $q(x)$. We can now assign the probability the event occurs to our new random variable $Z$ as: \(Z \sim \text{Bernoulli}(\frac{q(x)}{Mp(x)})\)</p> <p>Now that $Z$ is well defined, we turn our attention to the following:</p> \[X \space | \space Z=1\] <p>We wish to answer: what is the distribution of $X$ after we’ve accepted the sample? We want to show that given an accepted sample, the sample comes from our target distribution $q(x)$. To show that we’ll need to prove:</p> \[\Pr(X \in A | Z=1) = Q(x)\] <p>where $A$ is the sample space of $q(x)$.</p> <p>Using Bayes’ Theorem we can rewrite $\Pr(X \in A \vert Z=1)$ as:</p> \[\Pr(X \in A | Z=1) = \frac{\Pr(Z = 1 | X \in A) \cdot \Pr(X \in A)}{\Pr(Z=1)}\] <p>Lets turn our attention to the numerator. Since we have a conditional probability, we can make the following observation:</p> \[\Pr(Z = 1 | X \in A) = \frac{\Pr(Z=1 \cap X \in A)}{\Pr(X \in A)}\] <p>By multiplying both sides by $\Pr(X \in A)$ and plugging the right hand side into the numerator we arrive at:</p> \[\Pr(X \in A | Z=1) = \frac{\Pr(Z=1 \cap X \in A)}{\Pr(Z=1)}\] <p>Looking deeper into $\Pr(Z=1 \cap K \in A)$, this is something we can evaluate: By the law of Total Probability:</p> \[\Pr(Z=1 \cap K \in A) = \int_{A} (U &lt; \frac{q(x)}{Mp(x)}) \cdot p(x)\text{dx} = \iint_{0}^{1} (U &lt; \frac{q(x)}{Mp(x)}) \cdot p(x) \text{dx}\] \[\Rightarrow \int_{-\infty}^{\infty} \frac{q(x)}{Mp(x)}\cdot p(x) \text{dx} \frac{1}{M} \int_{-\infty}^{\infty}q(x)\text{dx} = \frac{1}{M} \cdot Q(x)\] <p>Now we turn our focus to the denominator $\Pr(Z=1)$.</p> \[\Pr(Z=1) = \int_{-\infty}^{\infty} 1(U &lt; \frac{q(x)}{Mp(x)}) p(x) \text{dx} = \int_{-\infty}^{\infty} \frac{q(x)}{Mp(x)}p(x) \text{dx} = \frac{1}{M} \int_{-\infty}^{\infty} q(x)\text{dx} = \frac{1}{M}\] <p>Finishing up we arrive at out final result:</p> \[\Pr(X \in A | Z=1) = \frac{\frac{1}{M} \Pr(X \in A)}{\frac{1}{M}} = \Pr(X \in A) = Q(x)\] <p>Therefore, given we accept the random variable we sampled, we’ve shown $X \sim q(x)$.</p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
